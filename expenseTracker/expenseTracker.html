<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-size: 3vh;
        }
       .expenseTracker, .container, #spendingTracker, .journalEntry {
           display: flex;
           flex-direction: column;
       }
       .expenseTracker {
           width: 50vw;
           margin: auto;
           padding: 1vw;
           border: 1px solid black;
       }
       .journalEntry {           
           border: 1px solid black;
           padding: 1vw;

       }
       .entrySection {
           display: flex;
           justify-content: space-between;
       }
       input {
           font-size: 75%;
       }
       button, input {
           height: 5vh;
       }
       button, input, .journalEntry {
            margin-top: 5%;
       }
       .deleteButton {
           height: 5vh;
           width: 50%;
           display: flex;
           align-items: center;
           justify-content: center;
           font-weight: 700;
           cursor: pointer;
           border: 1px solid transparent;
           margin: auto;
       }
       .deleteButton:hover {
           border: 1px solid red;
       }

    </style>
</head>
<!-- Create an expense tracker app. Use an input field for a number and a description of the expense. -->
<body>
    <div class="expenseTracker">
        <h1>JavaScript expense tracker</h1>
        <div class="container">
            <label for="expenseAmount">How much did you spend?</label>
            <input type="number" name="exepnseAmount" id="expenseAmount" required>    
        </div>
        <div class="container">
            <label for="expenseDescription">What did you spend it on? (Maximum 25 characters)</label>
            <input type="text" name="expenseDescription" id="expenseDescription" maxlength="25" required>    
        </div>
        <div class="container">
            <button class="addButton">Add</button>
        </div>
        <div class="container" id="spendingTracker"></div>
        <div class="journalTotal"></div>

    </div>
<script>
/* Amount spent object which will hold all the required inforamtion. */
let amountSpent = {
    entries: {}, /* Hold all the entries with a timestamp */
    total: 0,
    createEntry: createNewEntry, /* Create new entry function */
    findTotal: findTotalSpent /* Find total spent */
}

/* Entry constructor */
function Entry(value, desc) {
    this.amount = Number.parseFloat(value).toFixed(2) + " £" ;
    this.description = desc;
}

/* Create new entry */
function createNewEntry() {
    /* Get the date object to create a timestamp */
    let currentDate = new Date();
    /* Create a time stamp to keep track of entries */
    let timeStamp = currentDate.getHours() + ':' + currentDate.getMinutes() + ':' + currentDate.getSeconds() + ':' + currentDate.getMilliseconds() + ' '  + currentDate.getDate() + '/' + currentDate.getMonth() + '/' + currentDate.getFullYear();
    /* Using logic to check if values filled out. */
    if(document.querySelector('#expenseAmount').value && document.querySelector('#expenseDescription').value) {
        /* Create a new Entry object in entries with the timeStamp as a name. */
        amountSpent.entries[timeStamp] = new Entry(document.querySelector('#expenseAmount').value, document.querySelector('#expenseDescription').value); 
    } else {
        /* Generate alert if fields not filled out */
        alert("Please fill out required fields.");
        /* Return false to prevent further execution if logic fails */
        return false;
    }
    /* Reference to entries in the storage object */
    let entries = Object.values(amountSpent.entries);
    /* Store the HTML reference to be used to print the values in HTML */
    const spendingTracker = document.querySelector('#spendingTracker');
    /* Create a new div */
    const createDiv = document.createElement('div');
    createDiv.id = timeStamp;
    /* Add a journalEntry class to the newly created journal entry */
    createDiv.classList.add('journalEntry');
    /* Iterate throw entires array, Append new Div to HTML reference with inner HTML value
    which is the entry */
    for (const entry of entries) {
        spendingTracker.appendChild(createDiv).innerHTML = 
        "<div class='entrySection'>" + 
            "<div>Date created:</div>" + '<div>' + timeStamp +'</div>' + "</div>" 
            + " " + 
        "<div class='entrySection'>" + 
            "<div>Entry description:</div>" + '<div>' + entry.description +'</div>' + "</div>" 
            + " " + 
        "<div class='entrySection'>" + 
            "<div>Ammount:</div>" + '<div>' + entry.amount + '</div>' +"</div>" +
            "<div class='deleteButton'>DELETE</div>";
    }


    // Delete button //
    // Select all delete buttons on the page. //
    deleteButton = document.querySelectorAll(".deleteButton");
    // Loop throw delete buttons stored in deleteButton
    deleteButton.forEach(button => {
        /* On click of the delete button, delete entry and parent element. After elements deleted update total. */
        button.addEventListener('click', function() {
                // Delete an entry in the entries.
                delete amountSpent.entries[timeStamp];
                // Remove parent element.
                button.parentElement.remove()
                // Refresh total amount. 
                amountSpent.findTotal();
        });
    });    
}

/* Find total amount spent function */
function findTotalSpent() {
    /* Reference to entries in the storage object */
    let entries = Object.values(amountSpent.entries);
    /* Create an empty array to store numerical values */
    let array = [];
    /* Iterate throw entries */
    for (const entry of entries) {
        /* Push amount value as integer in to empty Array */
        array.push(parseInt(entry.amount));
    }
    /* Reduce the created array to find a total amount spent and update it. */
    amountSpent.total = array.reduce((a, b) => a + b, 0);
    /* Print the value of total in to HTML */
    document.querySelector('.journalTotal').innerHTML = "Total spent: " + Number.parseFloat(amountSpent.total).toFixed(2) + ' £';
}

/* Event listener for when the user submits information */
document.querySelector('.addButton').addEventListener('click', function() {
    /* Execute findTotal function on each entry */
    amountSpent.createEntry();
    amountSpent.findTotal();
});



</script>    
</body>
</html>